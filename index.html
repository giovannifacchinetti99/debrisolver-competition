<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DebriSolver â€“ Space Debris Conference 2026</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>

<style>
:root {
  --bg: #02040a;
  --card: #0b1422;
  --accent: #00ffe0;
  --accent2: #7c7cff;
  --accent3: #ff6b9d;
  --accent4: #ffd93d;
  --text: #e6ecf2;
  --muted: #9aa4b2;
}

* { 
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Inter', sans-serif;
  background:
    radial-gradient(circle at 50% 120%, #0b1f3a, var(--bg)),
    linear-gradient(180deg, #02040a, #040b18);
  color: var(--text);
  overflow-x: hidden;
  line-height: 1.6;
}

/* ---------- BACKGROUND LAYERS ---------- */
.background {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.background::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image:
    radial-gradient(1px 1px at 5% 10%, white, transparent),
    radial-gradient(1px 1px at 15% 80%, white, transparent),
    radial-gradient(1px 1px at 25% 30%, white, transparent),
    radial-gradient(1px 1px at 35% 60%, white, transparent),
    radial-gradient(1px 1px at 45% 20%, white, transparent),
    radial-gradient(1px 1px at 55% 75%, white, transparent),
    radial-gradient(1px 1px at 65% 40%, white, transparent),
    radial-gradient(1px 1px at 75% 15%, white, transparent),
    radial-gradient(1px 1px at 85% 55%, white, transparent),
    radial-gradient(1px 1px at 95% 90%, white, transparent);
  animation: stars 25s linear infinite;
}

@keyframes stars {
  0% { transform: translateY(-100vh); }
  100% { transform: translateY(100vh); }
}

.orbit {
  position: absolute;
  inset: -25%;
  border: 1px dashed rgba(124,124,255,0.08);
  border-radius: 50%;
  animation: rotate 140s linear infinite;
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ---------- SATELLITE COLLISION ---------- */
.collision {
  position: absolute;
  inset: 0;
  opacity: 0.35;
}

.collision.delay1 { animation-delay: 0s; }
.collision.delay2 { animation-delay: 6s; }
.collision.delay3 { animation-delay: 12s; }

.collision.pos1 { top: 10%; }
.collision.pos2 { top: 45%; }
.collision.pos3 { top: 75%; }

.sat {
  position: absolute;
  width: 18px;
  height: 10px;
  background: var(--accent);
  box-shadow: 0 0 10px rgba(0,255,224,0.6);
}

.sat::after {
  content: "";
  position: absolute;
  width: 6px;
  height: 6px;
  background: var(--accent2);
  right: -6px;
  top: 2px;
}

.sat.a {
  top: 40%;
  left: -10%;
  animation: satA 14s linear infinite;
}

.sat.b {
  top: 60%;
  right: -10%;
  animation: satB 14s linear infinite;
}

@keyframes satA {
  0% { transform: translateX(0); }
  45% { transform: translateX(55vw); }
  50% { opacity: 0; }
  100% { opacity: 0; }
}

@keyframes satB {
  0% { transform: translateX(0); }
  45% { transform: translateX(-55vw); }
  50% { opacity: 0; }
  100% { opacity: 0; }
}

.debris span {
  position: absolute;
  width: 4px;
  height: 4px;
  background: var(--accent2);
  top: 50%;
  left: 50%;
  opacity: 0;
  animation: debris 14s linear infinite;
}

@keyframes debris {
  0%, 45% { opacity: 0; transform: translate(0,0); }
  50% { opacity: 1; }
  70% {
    opacity: 0;
    transform: translate(
      calc(-50px + 100px * var(--dx)),
      calc(-50px + 100px * var(--dy))
    );
  }
}

/* ---------- GLOBAL ---------- */
section {
  position: relative;
  z-index: 1;
  max-width: 1200px;
  margin: auto;
  padding: 100px 24px;
}

h2 {
  font-family: 'Press Start 2P', monospace;
  font-size: 20px;
  color: var(--accent);
  margin-bottom: 48px;
  text-align: center;
  letter-spacing: 1px;
}

h3 {
  font-size: 18px;
  margin-bottom: 12px;
  color: var(--text);
}

.card {
  background: linear-gradient(135deg, rgba(12,23,40,0.95), rgba(11,20,34,0.9));
  border-radius: 20px;
  padding: 36px;
  box-shadow:
    0 0 0 1px rgba(0,255,224,0.1),
    0 20px 60px rgba(0,0,0,0.5);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow:
    0 0 0 1px rgba(0,255,224,0.2),
    0 24px 70px rgba(0,0,0,0.6);
}

/* ---------- HERO ---------- */
.hero {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 40px 24px;
}

.hero-content {
  max-width: 900px;
}

.hero h1 {
  font-family: 'Press Start 2P', monospace;
  font-size: clamp(32px, 6vw, 52px);
  color: var(--accent);
  margin-bottom: 24px;
  line-height: 1.3;
  text-shadow: 0 0 30px rgba(0,255,224,0.5);
}

.hero-subtitle {
  font-size: clamp(16px, 2.5vw, 20px);
  color: var(--muted);
  margin-bottom: 48px;
  font-weight: 300;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 24px;
  margin-top: 60px;
}

.stat-card {
  background: linear-gradient(135deg, rgba(124,124,255,0.1), rgba(0,255,224,0.05));
  border-radius: 16px;
  padding: 28px 20px;
  border: 1px solid rgba(0,255,224,0.15);
  transition: all 0.3s ease;
}

.stat-card:hover {
  border-color: var(--accent);
  transform: scale(1.05);
  box-shadow: 0 0 30px rgba(0,255,224,0.2);
}

.stat-number {
  font-family: 'Press Start 2P', monospace;
  font-size: 28px;
  color: var(--accent);
  display: block;
  margin-bottom: 8px;
}

.stat-label {
  font-size: 13px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* ---------- CHALLENGE ---------- */
.challenge-content {
  font-size: 17px;
  line-height: 1.9;
  color: var(--text);
  position: relative;
  padding-left: 24px;
  border-left: 3px solid var(--accent);
}

.challenge-content::before {
  content: "âš ";
  position: absolute;
  left: -40px;
  top: 0;
  font-size: 32px;
  color: var(--accent);
  animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.1); }
}

.highlight-box {
  background: linear-gradient(135deg, rgba(0,255,224,0.1), rgba(124,124,255,0.06));
  border-left: 4px solid var(--accent2);
  padding: 22px 28px;
  margin: 28px 0;
  border-radius: 10px;
  font-size: 15px;
  line-height: 1.8;
  transition: all 0.3s ease;
}

.highlight-box:hover {
  background: linear-gradient(135deg, rgba(0,255,224,0.12), rgba(124,124,255,0.08));
  border-left-color: var(--accent);
  transform: translateX(4px);
}

.highlight-box strong {
  color: var(--accent);
  font-weight: 700;
}

/* ---------- TEAM ---------- */
.team-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 32px;
}

@media (max-width: 1024px) {
  .team-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .team-grid {
    grid-template-columns: 1fr;
  }
}

.member {
  text-align: center;
  transition: transform 0.3s ease;
}

.avatar {
  width: 140px;
  height: 140px;
  margin: 0 auto 20px;
  border-radius: 50%;
  overflow: hidden;
  box-shadow: 0 0 40px rgba(0,255,224,0.3);
  border: 3px solid rgba(124,124,255,0.4);
  transition: all 0.3s ease;
}

.member:hover .avatar {
  box-shadow: 0 0 50px rgba(0,255,224,0.6);
  transform: scale(1.08);
}

.avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.member h3 {
  margin: 12px 0 6px;
  font-size: 20px;
}

.member .role {
  font-size: 14px;
  color: var(--accent2);
  font-weight: 600;
  margin-bottom: 12px;
  display: block;
}

.member p {
  font-size: 14px;
  color: var(--muted);
  line-height: 1.6;
  margin-bottom: 16px;
}

.member a {
  font-size: 13px;
  color: var(--accent);
  text-decoration: none;
  font-weight: 500;
  transition: all 0.2s ease;
}

.member a:hover {
  color: var(--accent2);
  text-decoration: underline;
}

/* ---------- SOLUTION ---------- */
.solution-content {
  font-size: 17px;
  line-height: 1.9;
}

.solution-content b {
  color: var(--accent);
  font-weight: 600;
}

.solution-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24px;
  margin-top: 32px;
}

.solution-feature {
  background: linear-gradient(135deg, rgba(124,124,255,0.08), rgba(0,255,224,0.03));
  border: 1px solid rgba(0,255,224,0.2);
  border-radius: 16px;
  padding: 28px;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  min-height: 180px;
}

.solution-feature::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(180deg, var(--accent), var(--accent2));
  transform: scaleY(0);
  transition: transform 0.3s ease;
}

.solution-feature::after {
  content: "";
  position: absolute;
  right: 0;
  top: 0;
  width: 120px;
  height: 120px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: top right;
  opacity: 0.1;
  transition: all 0.3s ease;
}

.solution-feature:nth-child(1)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><circle cx="60" cy="40" r="25" fill="none" stroke="%2300ffe0" stroke-width="3"/><path d="M 40 65 L 45 75 L 55 65 L 60 75 L 65 65 L 75 75 L 80 65" fill="none" stroke="%2300ffe0" stroke-width="2"/><rect x="35" y="80" width="50" height="30" rx="3" fill="none" stroke="%2300ffe0" stroke-width="2"/><line x1="45" y1="88" x2="75" y2="88" stroke="%2300ffe0" stroke-width="1.5"/><line x1="45" y1="95" x2="70" y2="95" stroke="%2300ffe0" stroke-width="1.5"/><line x1="45" y1="102" x2="65" y2="102" stroke="%2300ffe0" stroke-width="1.5"/></svg>');
}

.solution-feature:nth-child(2)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><path d="M 60 20 L 70 50 L 100 50 L 75 70 L 85 100 L 60 80 L 35 100 L 45 70 L 20 50 L 50 50 Z" fill="none" stroke="%237c7cff" stroke-width="3"/><rect x="40" y="55" width="40" height="35" rx="2" fill="none" stroke="%237c7cff" stroke-width="2"/><line x1="48" y1="65" x2="72" y2="65" stroke="%237c7cff" stroke-width="1.5"/><line x1="48" y1="73" x2="72" y2="73" stroke="%237c7cff" stroke-width="1.5"/><line x1="48" y1="81" x2="65" y2="81" stroke="%237c7cff" stroke-width="1.5"/></svg>');
}

.solution-feature:nth-child(3)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><circle cx="60" cy="60" r="35" fill="none" stroke="%23ff6b9d" stroke-width="3"/><text x="60" y="70" text-anchor="middle" fill="%23ff6b9d" font-size="40" font-weight="bold">$</text><path d="M 30 30 L 40 20 M 90 30 L 80 20 M 30 90 L 40 100 M 90 90 L 80 100" stroke="%23ff6b9d" stroke-width="2"/></svg>');
}

.solution-feature:nth-child(4)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120"><path d="M 60 25 L 50 45 L 30 45 L 45 58 L 38 78 L 60 65 L 82 78 L 75 58 L 90 45 L 70 45 Z" fill="none" stroke="%23ffd93d" stroke-width="3"/><circle cx="60" cy="60" r="28" fill="none" stroke="%23ffd93d" stroke-width="2"/><circle cx="60" cy="60" r="15" fill="none" stroke="%23ffd93d" stroke-width="2"/></svg>');
}

.solution-feature:hover::before {
  transform: scaleY(1);
}

.solution-feature:hover::after {
  opacity: 0.2;
  transform: scale(1.15) rotate(5deg);
}

.solution-feature:hover {
  border-color: var(--accent);
  transform: translateY(-6px);
  box-shadow: 0 15px 40px rgba(0,255,224,0.2);
}

.solution-feature:nth-child(2):hover {
  border-color: var(--accent2);
  box-shadow: 0 15px 40px rgba(124,124,255,0.2);
}

.solution-feature:nth-child(3):hover {
  border-color: var(--accent3);
  box-shadow: 0 15px 40px rgba(255,107,157,0.2);
}

.solution-feature:nth-child(4):hover {
  border-color: var(--accent4);
  box-shadow: 0 15px 40px rgba(255,217,61,0.2);
}

.solution-feature-icon {
  font-size: 36px;
  margin-bottom: 14px;
  display: block;
  position: relative;
  z-index: 1;
}

.solution-feature h4 {
  font-size: 17px;
  color: var(--accent2);
  margin-bottom: 10px;
  font-weight: 700;
  position: relative;
  z-index: 1;
}

.solution-feature:nth-child(1) h4 {
  color: var(--accent);
}

.solution-feature:nth-child(3) h4 {
  color: var(--accent3);
}

.solution-feature:nth-child(4) h4 {
  color: var(--accent4);
}

.solution-feature p {
  font-size: 14px;
  color: var(--muted);
  line-height: 1.7;
  position: relative;
  z-index: 1;
  max-width: 85%;
}

@media (max-width: 768px) {
  .solution-grid {
    grid-template-columns: 1fr;
  }
  
  .solution-feature p,
  .step-description {
    max-width: 100%;
  }
}

/* ---------- SOLUTION LINKS ---------- */
.solution-links-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-top: 24px;
}

.solution-link-card {
  background: linear-gradient(135deg, rgba(0,255,224,0.1), rgba(124,124,255,0.05));
  border: 1px solid rgba(0,255,224,0.2);
  border-radius: 12px;
  padding: 20px;
  text-decoration: none;
  color: inherit;
  transition: all 0.3s ease;
  display: block;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.solution-link-card::after {
  content: "go to section â†’";
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 12px;
  color: var(--accent);
  opacity: 0;
  transition: opacity 0.3s ease;
  font-weight: 600;
}

.solution-link-card:hover::after {
  opacity: 1;
}

.solution-link-card:hover {
  transform: translateY(-4px);
  border-color: var(--accent);
  box-shadow: 0 8px 25px rgba(0,255,224,0.2);
}

.solution-link-card h4 {
  color: var(--accent);
  margin-bottom: 8px;
  font-size: 16px;
}

.solution-link-card p {
  font-size: 14px;
  color: var(--muted);
  margin: 0;
}

@media (max-width: 768px) {
  .solution-links-grid {
    grid-template-columns: 1fr;
  }
}

/* ---------- CHARTS ---------- */
.chart-section {
  margin-bottom: 48px;
}

.chart-title {
  font-family: 'Inter', sans-serif;
  font-size: 22px;
  font-weight: 600;
  color: var(--accent2);
  margin: 24px;
  text-align: center;
}

.chart-container {
  width: 100%;
  height: 500px;
  background: linear-gradient(135deg, #1a1a2e, #16213e);
  border-radius: 16px;
  box-shadow: 
    inset 0 2px 10px rgba(0,0,0,0.3),
    0 4px 20px rgba(0,0,0,0.4);
  padding: 20px;
}

.charts-grid {
  display: grid;
  gap: 48px;
}

/* ---------- IMAGE RESULTS ---------- */
.results-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 28px;
  margin-top: 32px;
}

.result-card {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.result-card figure {
  margin: 0;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.result-card img {
  width: 100%;
  height: 320px;
  object-fit: cover;
  border-radius: 12px;
  margin-bottom: 20px;
  flex: 1;
  background: linear-gradient(135deg, #1a1a2e, #0f3460);
}

.result-card figcaption {
  text-align: center;
  font-size: 15px;
  color: var(--accent2);
  font-weight: 600;
  letter-spacing: 0.5px;
}

@media (max-width: 1024px) {
  .results-grid {
    grid-template-columns: 1fr;
  }
  
  .result-card img {
    height: 400px;
  }
}

/* ---------- STATS SECTION ---------- */
.stats-section {
  background: linear-gradient(135deg, rgba(124,124,255,0.05), rgba(0,255,224,0.03));
  border-radius: 20px;
  padding: 20px 15px;
  margin-bottom: 48px;
  border: 1px solid rgba(0,255,224,0.15);
}

.stats-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 32px;
}

.stat-box {
  text-align: center;
  padding: 24px;
  background: linear-gradient(135deg, rgba(11,20,34,0.6), rgba(12,23,40,0.4));
  border-radius: 16px;
  border: 1px solid rgba(0,255,224,0.1);
  transition: all 0.3s ease;
}

.stat-box:hover {
  transform: translateY(-8px);
  border-color: var(--accent);
  box-shadow: 0 12px 40px rgba(0,255,224,0.25);
}

.stat-box:nth-child(2):hover {
  border-color: var(--accent3);
  box-shadow: 0 12px 40px rgba(255,107,157,0.25);
}

.stat-box:nth-child(3):hover {
  border-color: var(--accent4);
  box-shadow: 0 12px 40px rgba(255,217,61,0.25);
}

.stat-box .number {
  font-family: 'Press Start 2P', monospace;
  font-size: 32px;
  color: var(--accent);
  display: block;
  margin-bottom: 12px;
  text-shadow: 0 0 20px rgba(0,255,224,0.5);
}

.stat-box .label {
  font-size: 13px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1.5px;
  line-height: 1.4;
}

/* ---------- KEY INNOVATION ---------- */
.innovation-section {
  background: linear-gradient(135deg, rgba(0,255,224,0.1), rgba(124,124,255,0.08));
  /* border-left: 5px solid var(--accent); */
  border-radius: 16px;
  padding: 15px;
  margin: 40px 0;
  position: relative;
  overflow: hidden;
}

.innovation-section::before {
  /* content: "ðŸŽ¯"; */
  position: absolute;
  right: 30px;
  top: 30px;
  font-size: 64px;
  opacity: 0.15;
  animation: pulse 3s ease-in-out infinite;
}

.innovation-title {
  font-size: 22px;
  color: var(--accent);
  font-weight: 700;
  margin-bottom: 18px;
  text-transform: uppercase;
  letter-spacing: 1px;
  position: relative;
  z-index: 1;
}

.innovation-description {
  font-size: 16px;
  line-height: 1.9;
  color: var(--text);
  position: relative;
  z-index: 1;
}

.innovation-description strong {
  color: var(--accent2);
  font-weight: 700;
}

.innovation-details {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-top: 28px;
}

@media (max-width: 768px) {
  .innovation-details {
    grid-template-columns: 1fr;
  }
}

.expandable-card {
  background: rgba(0,0,0,0.25);
  padding: 18px;
  border-radius: 10px;
  border-left: 3px solid var(--accent2);
  font-size: 14px;
  color: var(--text);
  font-weight: 500;
  transition: all 0.3s ease;
  position: relative;
  z-index: 1;
  cursor: pointer;
  overflow: hidden;
}

.expandable-card:hover {
  background: rgba(0,0,0,0.4);
  border-left-color: var(--accent);
  transform: translateX(4px);
}

.expandable-card .card-description {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.15s ease;
  margin-top: 10px;
  font-size: 15px;
  color: var(--muted);
  line-height: 1.6;
  will-change: max-height;
  backface-visibility: hidden;
  transform: translateZ(0);
}

.expandable-card.expanded .card-description {
  max-height: fit-content; /* adjust as needed */
}

@media (min-width: 769px) {
  .expandable-card:hover .card-description {
    max-height: 200px;
  }
}

/* ---------- KEY FINDINGS ---------- */
.recommendations-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
  margin-top: 32px;
}

@media (max-width: 1024px) {
  .recommendations-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .recommendations-grid {
    grid-template-columns: 1fr;
  }
}

.recommendation-card {
  background: linear-gradient(135deg, rgba(12,23,40,0.8), rgba(11,20,34,0.6));
  border-radius: 16px;
  padding: 28px;
  border: 1px solid rgba(0,255,224,0.15);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  min-height: 240px;
}

.recommendation-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  transform: scaleX(0);
  transition: transform 0.3s ease;
}

.recommendation-card::after {
  content: "";
  position: absolute;
  right: -20px;
  top: -20px;
  width: 140px;
  height: 140px;
  background-size: contain;
  background-repeat: no-repeat;
  opacity: 0.08;
  transition: all 0.3s ease;
}

.recommendation-card:nth-child(1)::before {
  background: linear-gradient(90deg, var(--accent), #00d4c4);
}

.recommendation-card:nth-child(1)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><circle cx="70" cy="50" r="30" fill="none" stroke="%2300ffe0" stroke-width="4"/><path d="M 50 80 L 55 95 L 70 85 L 85 95 L 90 80" fill="none" stroke="%2300ffe0" stroke-width="3"/><rect x="40" y="100" width="60" height="30" rx="4" fill="none" stroke="%2300ffe0" stroke-width="3"/><circle cx="50" cy="35" r="3" fill="%2300ffe0"/><circle cx="90" cy="35" r="3" fill="%2300ffe0"/><circle cx="70" cy="25" r="3" fill="%2300ffe0"/></svg>');
}

.recommendation-card:nth-child(2)::before {
  background: linear-gradient(90deg, var(--accent2), #a78bfa);
}

.recommendation-card:nth-child(2)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><rect x="30" y="30" width="80" height="90" rx="5" fill="none" stroke="%237c7cff" stroke-width="4"/><line x1="45" y1="50" x2="95" y2="50" stroke="%237c7cff" stroke-width="2.5"/><line x1="45" y1="65" x2="90" y2="65" stroke="%237c7cff" stroke-width="2.5"/><line x1="45" y1="80" x2="85" y2="80" stroke="%237c7cff" stroke-width="2.5"/><circle cx="70" cy="105" r="8" fill="none" stroke="%237c7cff" stroke-width="3"/><path d="M 70 97 L 70 75" stroke="%237c7cff" stroke-width="2"/></svg>');
}

.recommendation-card:nth-child(3)::before {
  background: linear-gradient(90deg, var(--accent3), #fb7185);
}

.recommendation-card:nth-child(3)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><circle cx="70" cy="70" r="45" fill="none" stroke="%23ff6b9d" stroke-width="4"/><text x="70" y="85" text-anchor="middle" fill="%23ff6b9d" font-size="50" font-weight="bold">$</text><circle cx="40" cy="40" r="8" fill="%23ff6b9d" opacity="0.6"/><circle cx="100" cy="40" r="8" fill="%23ff6b9d" opacity="0.6"/><circle cx="40" cy="100" r="8" fill="%23ff6b9d" opacity="0.6"/><circle cx="100" cy="100" r="8" fill="%23ff6b9d" opacity="0.6"/></svg>');
}

.recommendation-card:nth-child(4)::before {
  background: linear-gradient(90deg, var(--accent4), #fbbf24);
}

.recommendation-card:nth-child(4)::after {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><circle cx="70" cy="70" r="40" fill="none" stroke="%23ffd93d" stroke-width="4"/><circle cx="70" cy="70" r="25" fill="none" stroke="%23ffd93d" stroke-width="3"/><path d="M 30 70 L 50 70 M 90 70 L 110 70 M 70 30 L 70 50 M 70 90 L 70 110" stroke="%23ffd93d" stroke-width="3"/><circle cx="70" cy="70" r="8" fill="%23ffd93d"/></svg>');
}

.recommendation-card:hover::before {
  transform: scaleX(1);
}

.recommendation-card:hover::after {
  opacity: 0.15;
  transform: scale(1.1) rotate(5deg);
}

.recommendation-card:hover {
  transform: translateY(-4px);
}

.recommendation-card:nth-child(1):hover {
  border-color: var(--accent);
  box-shadow: 0 12px 40px rgba(0,255,224,0.2);
}

.recommendation-card:nth-child(2):hover {
  border-color: var(--accent2);
  box-shadow: 0 12px 40px rgba(124,124,255,0.2);
}

.recommendation-card:nth-child(3):hover {
  border-color: var(--accent3);
  box-shadow: 0 12px 40px rgba(255,107,157,0.2);
}

.recommendation-card:nth-child(4):hover {
  border-color: var(--accent4);
  box-shadow: 0 12px 40px rgba(255,217,61,0.2);
}

.recommendation-icon {
  font-size: 40px;
  margin-bottom: 16px;
  display: block;
  position: relative;
  z-index: 1;
}

.recommendation-card h4 {
  font-size: 18px;
  color: var(--accent);
  margin-bottom: 12px;
  font-weight: 700;
  text-transform: none;
}

.recommendation-card p {
  font-size: 14px;
  color: var(--text);
  line-height: 1.6;
  margin: 0;
}

.recommendation-list {
  list-style: none;
  padding: 0;
  position: relative;
  z-index: 1;
}

.recommendation-list li {
  font-size: 14px;
  color: var(--text);
  line-height: 1.8;
  padding-left: 24px;
  position: relative;
  margin-bottom: 12px;
}

.recommendation-list li::before {
  content: "â–¸";
  position: absolute;
  left: 0;
  font-weight: bold;
}

.recommendation-card:nth-child(1) .recommendation-list li::before {
  color: var(--accent);
}

.recommendation-card:nth-child(2) .recommendation-list li::before {
  color: var(--accent2);
}

.recommendation-card:nth-child(3) .recommendation-list li::before {
  color: var(--accent3);
}

.recommendation-card:nth-child(4) .recommendation-list li::before {
  color: var(--accent4);
}

/* ---------- METHODOLOGY ---------- */
.methodology-steps {
  display: grid;
  gap: 28px;
  margin-top: 32px;
}

.methodology-step {
  background: linear-gradient(90deg, rgba(0,255,224,0.08), transparent);
  border-left: 4px solid var(--accent);
  padding: 28px 32px;
  border-radius: 0 16px 16px 0;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  min-height: 180px;
}

.methodology-step::before {
  content: "";
  position: absolute;
  right: 0;
  top: 0;
  width: 200px;
  height: 100%;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: top right;
  opacity: 0.12;
  transition: all 0.3s ease;
  filter: brightness(1.2);
}

.methodology-step:nth-child(1)::before {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><circle cx="100" cy="100" r="80" fill="none" stroke="%2300ffe0" stroke-width="3"/><circle cx="100" cy="100" r="60" fill="none" stroke="%2300ffe0" stroke-width="2"/><circle cx="100" cy="100" r="40" fill="none" stroke="%2300ffe0" stroke-width="1"/><circle cx="150" cy="60" r="8" fill="%2300ffe0"/><circle cx="70" cy="140" r="6" fill="%237c7cff"/><circle cx="130" cy="120" r="5" fill="%23ff6b9d"/><path d="M 100 20 L 105 30 M 100 180 L 95 170 M 20 100 L 30 105 M 180 100 L 170 95" stroke="%2300ffe0" stroke-width="2"/></svg>');
  border-left-color: var(--accent);
}

.methodology-step:nth-child(2)::before {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="%237c7cff"/></marker></defs><circle cx="60" cy="80" r="20" fill="none" stroke="%237c7cff" stroke-width="3"/><circle cx="140" cy="80" r="20" fill="none" stroke="%237c7cff" stroke-width="3"/><line x1="80" y1="80" x2="120" y2="80" stroke="%23ff6b9d" stroke-width="3" marker-end="url(%23arrow)"/><path d="M 60 100 Q 100 140 140 100" fill="none" stroke="%23ffd93d" stroke-width="2" stroke-dasharray="5,5"/><circle cx="100" cy="130" r="8" fill="%23ff6b9d"/><text x="100" y="25" text-anchor="middle" fill="%237c7cff" font-size="16" font-weight="bold">TCA</text></svg>');
  border-left-color: var(--accent2);
}

.methodology-step:nth-child(3)::before {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect x="20" y="140" width="30" height="40" fill="%23ff6b9d" opacity="0.7"/><rect x="60" y="100" width="30" height="80" fill="%23ff6b9d" opacity="0.8"/><rect x="100" y="60" width="30" height="120" fill="%23ff6b9d"/><rect x="140" y="80" width="30" height="100" fill="%23ff6b9d" opacity="0.9"/><line x1="20" y1="180" x2="180" y2="180" stroke="%2300ffe0" stroke-width="2"/><line x1="20" y1="180" x2="20" y2="40" stroke="%2300ffe0" stroke-width="2"/><polyline points="35,130 75,90 115,50 155,70" fill="none" stroke="%23ffd93d" stroke-width="3"/><circle cx="35" cy="130" r="5" fill="%23ffd93d"/><circle cx="75" cy="90" r="5" fill="%23ffd93d"/><circle cx="115" cy="50" r="5" fill="%23ffd93d"/><circle cx="155" cy="70" r="5" fill="%23ffd93d"/></svg>');
  border-left-color: var(--accent3);
}

.methodology-step:nth-child(4)::before {
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><ellipse cx="100" cy="100" rx="80" ry="30" fill="none" stroke="%23ffd93d" stroke-width="2"/><path d="M 20 100 Q 100 60 180 100" fill="none" stroke="%23ffd93d" stroke-width="2" stroke-dasharray="5,3"/><rect x="85" y="85" width="30" height="8" fill="%2300ffe0"/><rect x="90" y="88" width="5" height="15" fill="%237c7cff"/><rect x="105" y="88" width="5" height="15" fill="%237c7cff"/><circle cx="100" cy="100" r="3" fill="%23ff6b9d"/><path d="M 100 70 L 100 50 M 95 52 L 100 50 L 105 52" stroke="%2300ffe0" stroke-width="2" fill="none"/><text x="100" y="45" text-anchor="middle" fill="%2300ffe0" font-size="12" font-weight="bold">Î”SMA</text></svg>');
  border-left-color: var(--accent4);
}

.methodology-step:nth-child(2) {
  background: linear-gradient(90deg, rgba(124,124,255,0.08), transparent);
}

.methodology-step:nth-child(3) {
  background: linear-gradient(90deg, rgba(255,107,157,0.08), transparent);
}

.methodology-step:nth-child(4) {
  background: linear-gradient(90deg, rgba(255,217,61,0.08), transparent);
}

.methodology-step:hover {
  transform: translateX(12px);
}

.methodology-step:hover::before {
  opacity: 0.25;
  transform: scale(1.1);
}

.step-label {
  font-family: 'Press Start 2P', monospace;
  font-size: 11px;
  color: var(--accent);
  margin-bottom: 12px;
  display: block;
  position: relative;
  z-index: 1;
}

.methodology-step:nth-child(2) .step-label {
  color: var(--accent2);
}

.methodology-step:nth-child(3) .step-label {
  color: var(--accent3);
}

.methodology-step:nth-child(4) .step-label {
  color: var(--accent4);
}

.step-title {
  font-size: 19px;
  color: var(--text);
  font-weight: 700;
  margin-bottom: 10px;
  position: relative;
  z-index: 1;
}

.step-description {
  font-size: 14px;
  color: var(--muted);
  line-height: 1.8;
  position: relative;
  z-index: 1;
  max-width: 100%;
}

/* ---------- DATA SOURCES ---------- */
.data-sources-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 16px;
}

.data-source-card {
  background: linear-gradient(135deg, rgba(124,124,255,0.08), rgba(0,255,224,0.03));
  border: 1px solid rgba(0,255,224,0.15);
  border-radius: 12px;
  padding: 16px;
  display: flex;
  align-items: center;
  transition: all 0.3s ease;
}

.data-source-card:hover {
  transform: translateY(-2px);
  border-color: var(--accent);
  box-shadow: 0 4px 15px rgba(0,255,224,0.1);
}

.data-icon {
  font-size: 24px;
  margin-right: 12px;
  flex-shrink: 0;
}

.data-content h5 {
  font-size: 14px;
  color: var(--accent2);
  margin: 0 0 4px 0;
  font-weight: 600;
}

.data-content p {
  font-size: 12px;
  color: var(--muted);
  margin: 0;
  line-height: 1.4;
}

.data-sources-header {
  font-size: 18px;
  color: var(--accent);
  margin-bottom: 16px;
  font-weight: 600;
  text-align: center;
  margin: 30px 0 0 0;
}

/* ---------- DOWNLOAD SECTION ---------- */
.download-section {
  background: linear-gradient(135deg, rgba(0,255,224,0.1), rgba(124,124,255,0.08));
  border-radius: 20px;
  padding: 48px;
  text-align: center;
  border: 2px solid rgba(0,255,224,0.2);
  position: relative;
  overflow: hidden;
}

.download-section::before {
  content: "";
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(0,255,224,0.1) 0%, transparent 70%);
  animation: rotate 20s linear infinite;
}

.download-title {
  font-family: 'Press Start 2P', monospace;
  font-size: 24px;
  color: var(--accent);
  margin-bottom: 16px;
  position: relative;
  z-index: 1;
}

.download-subtitle {
  font-size: 16px;
  color: var(--muted);
  margin-bottom: 40px;
  position: relative;
  z-index: 1;
}

.download-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 24px;
  position: relative;
  z-index: 1;
}

.download-card {
  background: linear-gradient(135deg, rgba(11,20,34,0.95), rgba(12,23,40,0.9));
  border: 2px solid rgba(0,255,224,0.2);
  border-radius: 16px;
  padding: 32px 24px;
  text-decoration: none;
  display: block;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.download-card::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(0,255,224,0.15), rgba(124,124,255,0.1));
  opacity: 0;
  transition: opacity 0.3s ease;
}

.download-card:hover::before {
  opacity: 1;
}

.download-card:hover {
  transform: translateY(-8px) scale(1.02);
  border-color: var(--accent);
  box-shadow: 0 20px 60px rgba(0,255,224,0.3);
}

.download-icon {
  font-size: 48px;
  margin-bottom: 16px;
  display: block;
  position: relative;
  z-index: 1;
}

.download-card-title {
  font-size: 18px;
  color: var(--accent);
  font-weight: 700;
  margin-bottom: 8px;
  position: relative;
  z-index: 1;
}

.card-title {
  font-size: 18px;
  color: var(--accent2);
  font-weight: 700;
  margin-bottom: 8px;
  position: relative;
  z-index: 1;
}

.download-card-desc {
  font-size: 13px;
  color: var(--muted);
  position: relative;
  z-index: 1;
}

@media (max-width: 768px) {
  .recommendations-grid {
    grid-template-columns: 1fr;
  }
  
  .download-section {
    padding: 32px 24px;
  }
  
  .download-title {
    font-size: 18px;
  }
}

/* ---------- FOOTER ---------- */
footer {
  text-align: center;
  padding: 60px 20px;
  font-size: 14px;
  color: var(--muted);
  border-top: 1px solid rgba(255,255,255,0.05);
}

/* ---------- AG GRID CUSTOM THEME ---------- */
.ag-theme-custom {
  --ag-background-color: rgba(11,20,34,0.9);
  --ag-foreground-color: #e6ecf2;
  --ag-header-background-color: rgba(12,23,40,0.95);
  --ag-header-foreground-color: #00ffe0;
  --ag-odd-row-background-color: rgba(124,124,255,0.05);
  --ag-row-hover-color: rgba(0,255,224,0.1);
  --ag-border-color: rgba(0,255,224,0.2);
  --ag-data-color: #e6ecf2;
  --ag-secondary-foreground-color: #9aa4b2;
  --ag-disabled-foreground-color: #666;
}

.ag-theme-custom .ag-header {
  background: linear-gradient(135deg, rgba(12,23,40,0.95), rgba(11,20,34,0.9));
  border-bottom: 1px solid rgba(0,255,224,0.2);
}

.ag-theme-custom .ag-header-cell-text {
  color: #00ffe0;
  font-weight: 600;
}

.ag-theme-custom .ag-row {
  border-bottom: 1px solid rgba(0,255,224,0.1);
}

.ag-theme-custom .ag-row:hover {
  background-color: rgba(0,255,224,0.1);
}

.action-btn {
  background: linear-gradient(135deg, rgba(0,255,224,0.2), rgba(124,124,255,0.1));
  border: 1px solid rgba(0,255,224,0.3);
  color: #00ffe0;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 500;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.action-btn:hover {
  background: linear-gradient(135deg, rgba(0,255,224,0.3), rgba(124,124,255,0.2));
  border-color: #00ffe0;
  transform: scale(1.05);
}

.btn-text {
  margin-right: 4px;
}

.btn-icon {
  font-size: 14px;
}

@media (max-width: 768px) {
  .btn-text {
    display: none;
  }
}
</style>

<style>

        #myGrid {
            height: 400px;
            width: 90%;
            margin: 50px auto;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        /* Stile del popup */
        #popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background-color: #ffffff;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease-in-out;
            min-width: 300px;
            text-align: center;
        }

        /* Mostra il popup */
        #popup.show {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
        }

        #popup h3 {
            margin-top: 0;
            font-size: 1.2em;
            color: #333;
        }

        #popup p {
            margin: 10px 0 0 0;
            color: #555;
            font-weight: bold;
        }

        /* Overlay sfocato dietro il popup */
        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.2);
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        #overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        /* Bottone chiudi popup */
        #popup button {
            margin-top: 15px;
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            background-color: #007bff;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #popup button::after {
            content: "Close";
        }
    </style>


<style>
  #overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    opacity: 0;
    pointer-events: none;
    transition: 0.3s;
}

#overlay.show {
    opacity: 1;
    pointer-events: auto;
}

#popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    min-width: 280px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    opacity: 0;
    transition: 0.3s;
}

#popup.show {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
}

.critical-container {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.critical-badge {
    padding: 8px 12px;
    border-radius: 8px;
    color: #fff;
    font-size: 14px;
    display: flex;
    gap: 6px;
    align-items: center;
}

.critical-badge.cr1 { background: #d9534f; }
.critical-badge.cr2 { background: #f0ad4e; }
.critical-badge.cr3 { background: #5bc0de; }

.critical-extra {
    width: 100%;
    margin-top: 10px;
    font-size: 13px;
    color: #555;
}
</style>

<style>

  .name-cell {
    display: flex;
    flex-direction: column;
    line-height: 1.2;
}

.name-company {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    color: #6c757d;
}

.name-ids {
    font-size: 14px;
    font-weight: 500;
    color: white;
}

.name-ids .vs {
    font-size: 12px;
    margin: 0 4px;
    color: #999;
}
</style>

<style>

          #myGridConjunction {
            height: 400px;
            width: 90%;
            margin: 50px auto;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

                 #myGridEvents {
            height: 400px;
            width: 90%;
            margin: 50px auto;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

#myGridEvents2 {
            height: 400px;
            width: 90%;
            margin: 50px auto;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

      #myGridEvents3 {
            height: 400px;
            width: 90%;
            margin: 50px auto;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
</style>

<!-- stile della colonna espandibile -->
<style>
        #myGridEvents4 {
            height: 600px;
            width: 100%;
        }



        .vs {
            color: #e74c3c;
            font-weight: bold;
            margin: 0 4px;
        }

        /* Container badge critical (vista compatta) */
        .critical-summary {
            display: flex;
            gap: 8px;
            align-items: center;
            font-size: 12px;
            cursor: pointer;
        }

        .critical-summary-badge {
            background: #e8f4f8;
            border: 1px solid #3498db;
            border-radius: 4px;
            padding: 4px 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .critical-summary:hover {
            opacity: 0.8;
        }

        /* Icona expand */
        .expand-icon {
            cursor: pointer;
            transition: transform 0.3s;
            font-size: 15px;
            color: #3498db;
            user-select: none;
        }

        .expand-icon.expanded {
            transform: rotate(90deg);
        }

        /* Full Width Row per dettagli espansi */
        .ag-full-width-row {
            background: transparent !important;
        }

        .detail-container {
            padding: 20px;
            /* background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); */
            border-radius: 8px;
            margin: 0 10px 10px 10px;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .detail-title {
            font-size: 16px;
            font-weight: 700;
            color: white;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .detail-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .detail-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .detail-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #7f8c8d;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .detail-value {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
        }

        .detail-card.cr1 {
            border-left: 4px solid #3498db;
        }

        .detail-card.cr2 {
            border-left: 4px solid #f39c12;
        }

        .detail-card.cr3 {
            border-left: 4px solid #e74c3c;
        }

        .detail-card.total {
            border-left: 4px solid #9b59b6;
        }

        .close-detail {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .close-detail:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }


    </style>


</head>

<body>

<div class="background">
  <div class="orbit"></div>

  <div class="collision pos1 delay1">
    <div class="sat a"></div>
    <div class="sat b"></div>
    <div class="debris">
      <span style="--dx:0.2;--dy:0.8"></span>
      <span style="--dx:0.8;--dy:0.3"></span>
      <span style="--dx:0.4;--dy:0.6"></span>
      <span style="--dx:0.6;--dy:0.2"></span>
    </div>
  </div>

  <div class="collision pos2 delay2">
    <div class="sat a"></div>
    <div class="sat b"></div>
    <div class="debris">
      <span style="--dx:0.1;--dy:0.9"></span>
      <span style="--dx:0.7;--dy:0.4"></span>
      <span style="--dx:0.5;--dy:0.7"></span>
    </div>
  </div>

  <div class="collision pos3 delay3">
    <div class="sat a"></div>
    <div class="sat b"></div>
    <div class="debris">
      <span style="--dx:0.3;--dy:0.6"></span>
      <span style="--dx:0.6;--dy:0.3"></span>
    </div>
  </div>
</div>

<!-- HERO -->
<section class="hero">
  <div class="hero-content">
    <h1>DebriSolver Competition</h1>
    <p class="hero-subtitle">Advancing Space Traffic Management through Data-Driven Solutions</p>
    


      <h2>The Challenge</h2>



  <!-- <div class="card"> -->
    <div class="stats-section">


                <!-- <div class="challenge-content"> -->
As the number of satellites in orbit continues to grow, effective space traffic management has 
become a global priority. In August and September 2024, two debris-generating events 
produced over <strong style="color: #00d4c4;">700 new objects</strong>, threatening hundreds of active spacecraft and revealing 
significant regulatory and technical gaps in collision prevention. Because these satellites 
support critical services such as telecommunications, Earth observation, navigation, and emergency 
response, their loss could severely impact global connectivity, security, and economic activity. 
Addressing these risks requires an integrated approach that combines technological innovation with 
coordinated policy, operations, and economic planning.
    <!-- </div> -->
    </div>
    

  <!-- </div> -->


  </div>
</section>




<!-- TEAM -->
<section>
  <h2>The Team</h2>
  <div class="team-grid">
    <div class="card member">
      <div class="avatar">
        <img src="images/elena.jpeg" alt="Elena Ancona">
      </div>
      <h3>Elena Ancona</h3>
      <span class="role">Space Traffic Management Solutions Engineer</span>
      <p>
        STM Solutions Engineer with over 10 years of experience in space operations. PhD in Aerospace Engineering, with professional background including operational roles at ESA and EUMETSAT. Former OneWeb Flight Dynamics Engineer, now collaborating with OKAPI:orbits on space sustainability.
      </p>
      <a href="https://www.linkedin.com/in/elenaancona/" target="_blank">LinkedIn â†’</a>
    </div>

    <div class="card member">
      <div class="avatar">
        <img src="images/giovanni.jpeg" alt="Giovanni Facchinetti">
      </div>
      <h3>Giovanni Facchinetti</h3>
      <span class="role">Space Debris Mitigation Engineer</span>
      <p>
        Space engineer focused on debris mitigation and orbital sustainability. Double Master's in Space Engineering from Politecnico di Milano and Beihang University. Worked for ESA's Advanced Concepts Team, specializing in long-term debris environment modeling.
      </p>
      <a href="https://www.linkedin.com/in/giovanni-facchinetti-421547201/" target="_blank">LinkedIn â†’</a>
    </div>

    <div class="card member">
      <div class="avatar">
        <img src="images/vincenzo.jpeg" alt="Vincenzo Quatraro">
      </div>
      <h3>Vincenzo Quatraro</h3>
      <span class="role">AI & Data Analytics Consultant</span>
      <p>
        AI and ML consultant and Team Lead in automotive industry, with expertise in data modeling and pattern discovery. Background includes 2.5 years of PhD research in Aerospace Engineering and a Master's in AI and ML from University of Leeds.
      </p>
      <a href="https://www.linkedin.com/in/vincenzo-quatraro-73679389/" target="_blank">LinkedIn â†’</a>
    </div>

    <div class="card member">
      <div class="avatar">
        <img src="images/diego.jpeg" alt="Diego Guerra">
      </div>
      <h3>Diego Guerra</h3>
      <span class="role">Spacecraft Telecommunications Engineer</span>
      <p>
        Principal Telecommunications Lead at Blue Origin on NASA Artemis Lunar Lander. Previously worked at SpaceX on first-generation Starlink LEO constellation. PhD in Electrical Engineering from Arizona State University.
      </p>
      <a href="https://www.linkedin.com/in/diegoguerra/" target="_blank">LinkedIn â†’</a>
    </div>
  </div>
</section>

<section class="hero">
  <div class="hero-content">
    <h2>Our Solutions</h2>
      <div class="card">
    <div class="stats-section">
This study analyzes the 2024 Long-March 6A fragmentation 
events <strong style="color: #00d4c4;">(700+ fragments)</strong> to quantify risks to critical space infrastructure. 
Through a systematic analysis of <strong style="color: #00d4c4;">over 500.000 CDMs</strong>, we identify operational 
criticalities in current STM frameworks and propose an integrated solution that 
combines technical innovation, regulatory harmonization (ESA-NASA standards), 
economic incentives (orbital tolls), and social protection (resilience of critical 
services). We introduce the <strong style="color: #00d4c4;">STM-ConOps Score</strong>, a composite metric for mission 
classification enabling proportionate regulation and quantitative guidelines 
compliance assessment.
    </div>

The following sections summarize our solution at a high level.<br>Click on each section to explore the underlying methodology in more detail.

<div class="solution-links-grid">
  <a href="#approach" class="solution-link-card">
    <h4>Our Approach</h4>
    <p>Integrated technical, regulatory, and economic solutions for orbital resilience</p>
  </a>
  <a href="#methodology" class="solution-link-card">
    <h4>Data Analysis</h4>
    <p>Systematic analysis of 570,000+ CDM messages and fragmentation events</p>
  </a>
  <a href="#findings" class="solution-link-card">
    <h4>Key Findings</h4>
    <p>Critical insights on debris dynamics and conjunction risk patterns</p>
  </a>
  <a href="#results" class="solution-link-card">
    <h4>Results</h4>
    <p>Visualizations and quantitative assessments of orbital safety challenges</p>
  </a>
</div>
    
  </div>

  
  </div>

  
</section>

  <!-- DELIVERABLES -->
<section>
  <div class="download-section">
    <div class="download-title">Access Full Documentation</div>
    <div class="download-subtitle">Complete research materials and conference deliverables</div>
    
    <div class="download-grid">
      <a href="https://drive.google.com/file/d/131D6JHt9sKyGyKVY0Itx9bm5CtM8gHuV/view?usp=sharing" target="_blank" class="download-card">
        <span class="download-icon">ðŸ“„</span>
        <div class="download-card-title">Full Research Paper</div>
        <div class="download-card-desc">Complete technical analysis and methodology (PDF)</div>
      </a>
      
      <a href="https://drive.google.com/file/d/1KqjeGaG2XWvsXTOI6e4sAN5adWxDgJ7r/view?usp=sharing" target="_blank" class="download-card">
        <span class="download-icon">ðŸ–¼ï¸</span>
        <div class="download-card-title">Conference Poster</div>
        <div class="download-card-desc">Visual presentation of key findings (PDF)</div>
      </a>
      
      <a href="https://drive.google.com/file/d/1E0Wy4oQUwUVBH_SUYjA_Z4RFq-YxnIcl/view?usp=sharing" target="_blank" class="download-card">
        <span class="download-icon">ðŸ’»</span>
        <div class="download-card-title">Executive Summary</div>
        <div class="download-card-desc">Two-page overview for decision makers (PDF)</div>
      </a>
      
      <a href="https://ssa.gov.sa/c/" target="_blank" class="download-card">
        <span class="download-icon">ðŸš€</span>
        <div class="download-card-title">Competition Page</div>
        <div class="download-card-desc">Official DebriSolver Competition 2025</div>
      </a>
    </div>
  </div>
</section>

<!-- SOLUTION -->
<section id="approach">
  <h2>Our Approach</h2>
  <div class="card">
    <div class="solution-content">
      Treating STM as a systemic challenge, we link technical risk detection with policy and economic sustainability for long-term orbital resilience. Our solution integrates technical innovation with regulatory and economic foresight, analyzing 2024 fragmentation events to extract lessons learned and propose actionable recommendations.
    </div>
    
    <div class="innovation-section">
      <div class="innovation-title">Key Innovation: STM-ConOps Score</div>
      <div class="innovation-description">
        Composite indicator capturing operational, environmental, and governance externalities across <strong>6 critical dimensions</strong>, enabling proportionate regulation and risk-based economic tools.
      </div>
      <!-- per ogni voce espandere giÃ¹:
       
      Orbital Regime Sensitivity (ORS)
Captures both the current and projected congestion of the target orbital shell, conjunction rates, debris
lifetime, and proximity to sensitive regions. This dimension highlights the importance of anticipating future
environmental stress due to planned launches and constellation growth.
Spacecraft Physical & Operational Characteristics (SPOC)
Assesses trackability, maneuverability, propulsion capability, attitude control reliability, and passivation
features. These properties determine the spacecraftâ€™s ability to participate safely in the orbital traffic system.
Mission Behaviour Complexity (MBC)
Reflects operations that increase unpredictability, such as formation flying, multi-phase deployments, or
proximity operations. Complex missions demand increased coordination and represent a higher potential for
operational conflict.
Debris & Failure Externality Potential (DFEP)
Quantifies the consequences of a catastrophic failure, based on mass, fragmentation likelihood, stored
energy (e.g., pressurised tanks), number of spacecraft involved, and compliance with post-mission disposal
guidelines.
Governance & Coordination Readiness (GCR)
Evaluates adherence to best practices, quality of ephemeris sharing, manoeuvre notifications, anomaly
reporting, and transparency. Operational culture is a key determinant of STM safety.
Failure-Mode Severity & Recoverability (FMSR)
Measures the spacecraftâ€™s ability to maintain controllability, enter safe modes, and remain trackable during
anomalies. Recoverability is essential for reducing uncontrolled conjunction risk.
      
      -->
      <div class="innovation-details">
        <div class="innovation-detail expandable-card">
          <div class="card-title">Orbital Regime Sensitivity (ORS)</div>
          <div class="card-description">Captures both the current and projected congestion of the target orbital shell, conjunction rates, debris lifetime, and proximity to sensitive regions. This dimension highlights the importance of anticipating future environmental stress due to planned launches and constellation growth.</div>
        </div>
        <div class="innovation-detail expandable-card">
          <div class="card-title">Spacecraft Physical & Operational Characteristics (SPOC)</div>
          <div class="card-description">Assesses trackability, maneuverability, propulsion capability, attitude control reliability, and passivation features. These properties determine the spacecraft's ability to participate safely in the orbital traffic system.</div>
        </div>
        <div class="innovation-detail expandable-card">
          <div class="card-title">Mission Behaviour Complexity (MBC)</div>
          <div class="card-description">Reflects operations that increase unpredictability, such as formation flying, multi-phase deployments, or proximity operations. Complex missions demand increased coordination and represent a higher potential for operational conflict.</div>
        </div>
        <div class="innovation-detail expandable-card">
          <div class="card-title">Debris & Failure Externality Potential (DFEP)</div>
          <div class="card-description">Quantifies the consequences of a catastrophic failure, based on mass, fragmentation likelihood, stored energy (e.g., pressurised tanks), number of spacecraft involved, and compliance with post-mission disposal guidelines.</div>
        </div>
        <div class="innovation-detail expandable-card">
          <div class="card-title">Governance & Coordination Readiness (GCR)</div>
          <div class="card-description">Evaluates adherence to best practices, quality of ephemeris sharing, manoeuvre notifications, anomaly reporting, and transparency. Operational culture is a key determinant of STM safety.</div>
        </div>
        <div class="innovation-detail expandable-card">
          <div class="card-title">Failure-Mode Severity & Recoverability (FMSR)</div>
          <div class="card-description">Measures the spacecraft's ability to maintain controllability, enter safe modes, and remain trackable during anomalies. Recoverability is essential for reducing uncontrolled conjunction risk.</div>
        </div>
      </div>
    </div>
    
      <div class="innovation-section">
      <div class="innovation-title">Multi-Domain Recommendations</div>
      <div class="innovation-description">
        An integrated STM solution combining technical, regulatory, economic, and social dimensions to enhance orbital safety and sustainability.
      </div>
    <div class="solution-grid">
      <div class="solution-feature">
        <span class="solution-feature-icon">ðŸ”¬</span>
        <h4>Technical Innovation</h4>
        <p>Enhanced SSA accuracy, systematic conjunction classification, and operator ephemeris prioritization</p>
      </div>
      
      <div class="solution-feature">
        <span class="solution-feature-icon">âš–ï¸</span>
        <h4>Regulatory Framework</h4>
        <p>Harmonize international standards, encourage data sharing, and establish unified STM framework</p>
      </div>
      
      <div class="solution-feature">
        <span class="solution-feature-icon">ðŸ’°</span>
        <h4>Economic Incentives</h4>
        <p>Risk-based orbital tolls, insurance mechanisms, and cost-sharing for active debris removal</p>
      </div>
      
      <div class="solution-feature">
        <span class="solution-feature-icon">ðŸ›¡ï¸</span>
        <h4>Social Protection</h4>
        <p>Critical services protection, UNCOPUOS alignment, and fostering international cooperation</p>
      </div>
    </div>
      </div>
  </div>
  </div>
  </div>
</section>

<!-- METHODOLOGY -->
<section id="methodology">
  <h2>Data Analysis</h2>
  <div class="card">
    <div class="methodology-steps">
      <div class="methodology-step">
        <span class="step-label">STEP A</span>
        <div class="step-title">Fragment Cloud Evolution</div>
        <div class="step-description">
          Reconstruct temporal evolution of debris populations by ingesting CDMs and tracking unique NORAD IDs. Binning logic separates "active" vs "inactive" fragments, with intelligent reactivation mechanism.
        </div>
      </div>
      
      <div class="methodology-step">
        <span class="step-label">STEP B</span>
        <div class="step-title">Conjunction Events Analysis</div>
        <div class="step-description">
          Systematic grouping of CDMs into physical conjunctions (same object pair and TCA). Classification: Critical (CR), Concerning (CN), Nominal (NO) based on collision probability, miss distance, and time-to-TCA.
        </div>
      </div>
      
      <div class="methodology-step">
        <span class="step-label">STEP C</span>
        <div class="step-title">Trend Evaluation & Criticality</div>
        <div class="step-description">
          Assess CDM source impact (HAC vs EPHEM). Develop maneuver detection logic through multiple CDMs analysis, source alternation patterns, and large Pc/MD shifts. Generate insights on operators' behavior patterns.
        </div>
      </div>
      
      <div class="methodology-step">
        <span class="step-label">STEP D</span>
        <div class="step-title">TLE-Based Maneuver Detection</div>
        <div class="step-description">
          TLEs (Â±7 days around TCA) screened for abrupt semi-major axis changes (Î”SMA > 400m) in the most critical conjunctions, validating operational response to high-risk events.
        </div>
      </div>
    </div>
    
    <!-- <div class="highlight-box" style="margin-top: 32px;"> -->
      <h4 class="data-sources-header">Data Sources</h4>
      <div class="data-sources-grid">
        <div class="data-source-card">
          <div class="data-icon">ðŸ“Š</div>
          <div class="data-content">
            <h5>570,000+ CDM Messages</h5>
            <p>Conjunction Data Messages of the fragmentation cloud</p>
          </div>
        </div>
        <div class="data-source-card">
          <div class="data-icon">ðŸ›°ï¸</div>
          <div class="data-content">
            <h5>Space-Track TLEs</h5>
            <p>Two-Line Element sets for orbital tracking</p>
          </div>
        </div>
        <div class="data-source-card">
          <div class="data-icon">ðŸ“¡</div>
          <div class="data-content">
            <h5>Seradata Dataset</h5>
            <p>Contextualization and satellite information</p>
          </div>
        </div>
        <div class="data-source-card">
          <div class="data-icon">ðŸŒ</div>
          <div class="data-content">
            <h5>Slingshot Laboratory</h5>
            <p>3D visualization and analysis tools</p>
          </div>
        </div>
        <div class="data-source-card">
          <div class="data-icon">ðŸ</div>
          <div class="data-content">
            <h5>Custom Python Routines</h5>
            <p>Automated data processing and modeling</p>
          </div>
        </div>
      </div>
    <!-- </div> -->
  </div>
</section>

<!-- RESULTS -->
<section id="findings">
  <h2>Key Findings</h2>

  <div class="card" style="margin-bottom: 48px;">

    
    <div class="recommendations-grid">
      <div class="recommendation-card">
        <h4>Systemic Risk Drivers</h4>
        <p>Event-level CDM classification and debris-cloud dynamics reveal systemic risk drivers in congested orbital regimes.</p>
      </div>
      
      <div class="recommendation-card">
        <h4>Persistent Fragmentation Impacts</h4>
        <p>Fragmentation impacts persist and evolve long after the initial event. Debris populations show continued activity through the CDMs dataset.</p>
      </div>
      
      <div class="recommendation-card">
        <h4>Broader Conjunction Context</h4>
        <p>Conjunctions cannot be treated as isolated events. Effective collision avoidance must account for the broader orbital neighborhood and constellation-level interactions, not just single object pairs.</p>
      </div>
    </div>
  </div>

  <h2 style="margin-top: 60px;">Results</h2>

    <!-- Chart 1 -->

        <h3 class="chart-title">TLEs for Manouver Detection</h3>
        <div class="chart-container" id="graficoManovra"></div>
   
 

    <!-- Chart 2 -->

        <h3 class="chart-title">Fragments Population Dynamics</h3>
        <div class="chart-container" id="graficoDebris"></div>
 
   

    <!-- Chart 3 -->

        <h3 class="chart-title">CDMs Classification</h3>
        <div class="chart-container" id="sunburstChart"></div>

  </div>




        <div id="myGrid" class="ag-theme-alpine ag-theme-custom"></div>
      

        <div id="myGridConjunction" class="ag-theme-alpine ag-theme-custom"></div>
     


 



<div id="myGridEvents" class="ag-theme-alpine ag-theme-custom"></div>

<div id="myGridEvents2" class="ag-theme-alpine ag-theme-custom"></div>

<div id="myGridEvents3" class="ag-theme-alpine ag-theme-custom"></div>

<div id="myGridEvents4" class="ag-theme-alpine ag-theme-custom"></div>

</section>

  <!-- Image Results -->
  <!-- <div class="results-grid"> -->
   <h3 class="chart-title">
    Interested in additional figures and in-depth analyses?
    Download the full paper for the complete set of results.
  </h3>


  </div>

<footer>
  Â© 2026 DebriSolver Team Â· Space Debris Conference Â· Riyadh
</footer>


<!-- SCRIPTS -->
<script>
// ========== CHART 1: ORBITAL MANEUVER ==========
var chart1 = echarts.init(document.getElementById('graficoManovra'));

var data = [
  ["2024-08-06 14:26:17", 6950.22],
  ["2024-08-06 19:11:49", 6950.22],
  ["2024-08-07 03:34:03", 6950.22],
  ["2024-08-07 14:26:28", 6950.19],
  ["2024-08-07 17:13:40", 6950.19],
  ["2024-08-07 22:16:42", 6953.09],
  ["2024-08-08 02:56:26", 6953.09],
  ["2024-08-08 17:38:48", 6950.06],
  ["2024-08-08 22:26:22", 6950.18],
  // ["2024-08-09 02:46:50", 6950.18],
  // ["2024-08-09 14:16:15", 6950.19],
  // ["2024-08-09 17:12:42", 6950.17]
];

var chartData = data.map(d => [new Date(d[0]), d[1]]);
var lineaRossa = new Date("2024-08-08T00:00:00");

chart1.setOption({
  tooltip: {
    trigger: 'axis',
    backgroundColor: 'rgba(0,0,0,0.8)',
    borderColor: '#00ffe0',
    textStyle: { color: '#ffffff' }
  },
  grid: {
    left: '12%',
    right: '8%',
    top: '12%',
    bottom: '10%'
  },
  xAxis: {
    type: 'time',
    name: 'Epoch',
    nameTextStyle: { color: '#ffffff', fontSize: 14 },
    nameGap: 35,
    min: '2024-08-07 12:00:00',
    max: '2024-08-08 18:00:00',
    axisLabel: {
      color: '#9aa4b2',
      fontSize: 12,
      formatter: function (value) {
        const d = new Date(value);
        return d.getFullYear() + '-' +
               String(d.getMonth()+1).padStart(2,'0') + '-' +
               String(d.getDate()).padStart(2,'0') + '\n' +
               String(d.getHours()).padStart(2,'0') + ':' +
               String(d.getMinutes()).padStart(2,'0');
      }
    },
    axisLine: { lineStyle: { color: '#444' }},
    splitLine: { lineStyle: { color: '#2a2a3e' }}
  },
  yAxis: {
    type: 'value',
    name: 'SMA [km]',
    min: 6949,
    max: 6954,
    nameTextStyle: { color: '#ffffff', fontSize: 14 },
    axisLabel: {
      color: '#9aa4b2',
      fontSize: 12
    },
    axisLine: { lineStyle: { color: '#444' }},
    splitLine: { lineStyle: { color: '#2a2a3e' }}
  },
  series: [{
    name: 'SMA',
    type: 'line',
    data: chartData,
    smooth: true,
    lineStyle: {
      width: 3,
      color: '#00ffe0'
    },
    itemStyle: {
      color: '#00ffe0'
    },
    areaStyle: {
      color: new echarts.graphic.LinearGradient(0,0,0,1, [
        { offset:0, color: 'rgba(0,255,224,0.4)' },
        { offset:1, color: 'rgba(0,255,224,0.05)' }
      ])
    },
    markLine: {
      symbol: 'none',
      data: [{
        xAxis: lineaRossa,
        lineStyle: {
          color: '#e74c3c',
          width: 2,
          type: 'dashed'
        },
        label: {
          show: true,
          formatter: 'Predicted TCA',
          color: '#e74c3c',
          position: 'insideEndTop',
          fontSize: 13,
          fontWeight: 'bold'
        }
      }]
    }
  }]
});

// ========== CHART 2: DEBRIS POPULATION ==========
var chart2 = echarts.init(document.getElementById('graficoDebris'));

var debrisData = {
  "inactive_long": [0, -56, -101, -152, -513, -545],
  "inactive_short": [-20, -146, -34, -133, -36, -44],
  "known_cont": [80, 10, 189, 320, 165, 186],
  "months": ["2024-08", "2024-09", "2024-10", "2025-02", "2025-06", "2025-08"],
  "new_frag": [5, 0, 4, 66, 8, 8],
  "react_long": [0, 0, 2, 6, 5, 0],
  "react_short": [0, 0, 1, 8, 3, 2],
  "total_active": [85, 10, 196, 400, 181, 196]
};

chart2.setOption({
  tooltip: {
    trigger: 'axis',
    axisPointer: { type: 'shadow' },
    backgroundColor: 'rgba(0,0,0,0.8)',
    borderColor: '#00ffe0',
    formatter: function (params) {
      let res = '<b style="color:#00ffe0">' + params[0].axisValue + '</b><br/>';
      params.forEach(p => {
        let v = Math.abs(p.value);
        if (v > 0) {
          res += p.marker + ' ' + p.seriesName + ': ' + v + '<br/>';
        }
      });
      return res;
    }
  },
  legend: {
    top: 10,
    textStyle: { color: '#9aa4b2', fontSize: 11 },
    data: [
      'New',
      'Known Continuous',
      'Reactivated < Threshold',
      'Reactivated â‰¥ Threshold',
      'Inactive < Threshold',
      'Inactive â‰¥ Threshold',
      'Total Active'
    ]
  },
  grid: {
    left: '6%',
    right: '6%',
    top: '30%',
    bottom: '8%',
    containLabel: true
  },
  xAxis: {
    type: 'value',
    axisLabel: {
      color: '#9aa4b2',
      formatter: v => Math.abs(v)
    },
    axisLine: { lineStyle: { color: '#444' }},
    splitLine: { lineStyle: { color: '#2a2a3e' }}
  },
  yAxis: {
    type: 'category',
    data: debrisData.months,
    axisLabel: { color: '#9aa4b2' },
    axisLine: { lineStyle: { color: '#444' }}
  },
  series: [
    {
      name: 'Total Active',
      type: 'bar',
      stack: 'active',
      itemStyle: { color: '#34495e', opacity: 0.35 },
      label: { show: true, position: 'right', fontWeight: 'bold', color: '#00ffe0' },
      data: debrisData.total_active
    },
    {
      name: 'New',
      type: 'bar',
      stack: 'sum',
      itemStyle: { color: '#1f77b4' },
      // label: { show: true, position: 'right', color: '#fff' },
      data: debrisData.new_frag
    },
    {
      name: 'Known Continuous',
      type: 'bar',
      stack: 'sum',
      itemStyle: { color: '#2ca02c' },
      // label: { show: true, position: 'right', color: '#fff' },
      data: debrisData.known_cont
    },
    {
      name: 'Reactivated < Threshold',
      type: 'bar',
      stack: 'sum',
      itemStyle: { color: '#ff7f0e' },
      // label: { show: true, position: 'right', color: '#fff' },
      data: debrisData.react_short
    },
    {
      name: 'Reactivated â‰¥ Threshold',
      type: 'bar',
      stack: 'sum',
      itemStyle: { color: '#d62728' },
      // label: { show: true, position: 'right', color: '#fff' },
      data: debrisData.react_long
    },
    {
      name: 'Inactive < Threshold',
      type: 'bar',
      stack: 'inactive',
      itemStyle: { color: '#8c564b' },
      label: {
        show: true,
        position: 'top',
        formatter: p => Math.abs(p.value),
        color: '#fff'
      },
      data: debrisData.inactive_short
    },
    {
      name: 'Inactive â‰¥ Threshold',
      type: 'bar',
      stack: 'inactive',
      itemStyle: { color: '#9467bd' },
      label: {
        show: true,
        position: 'left',
        formatter: p => Math.abs(p.value),
        color: '#fff'
      },
      data: debrisData.inactive_long
    }
  ]
});

// ========== CHART 3: SUNBURST ==========
var chart3 = echarts.init(document.getElementById('sunburstChart'));

var sunburstData = [
  {
    name: "CN",
    value: 62.1,
    itemStyle: { color: '#f1c40f' },
    label: { 
        position: 'inside', 
        fontSize: 14, 
        color: '#fff', 
        fontWeight: 'bold',
        formatter: function(params) {
            const pct = (params.value / TOTAL * 100).toFixed(1);
            return `${params.name}\n${pct}%`;
        }
    }, // Parent inside
    children: [
      { 
        name: "CN1", 
        value: 62.1*0.80, 
        itemStyle: { color: '#f1c40f' },
        label: { 
            position: 'outside', 
            fontSize: 12, 
            color: '#fff',
            formatter: function(params) {
                const pct = (params.value / TOTAL * 100).toFixed(1);
                return `${params.name}\n${pct}%`;
            }
        } // Child outside
      },
      { 
        name: "CN2", 
        value: 62.1*0.18, 
        itemStyle: { color: '#c9a300' },
        label: { 
            position: 'outside', 
            fontSize: 12, 
            color: '#fff',
            formatter: function(params) {
                const pct = (params.value / TOTAL * 100).toFixed(1);
                return `${params.name}\n${pct}%`;
            }
        } // Child outside
      },
      { 
        name: "CN3", 
        value: 62.1*0.02, 
        itemStyle: { color: '#8c6d00' },
        label: { 
          position: 'outside', // personalizzabile
          fontSize: 12, 
          color: '#fff',
          formatter: function(params) {
              const pct = (params.value / TOTAL * 100).toFixed(1);
              return `${params.name}\n${pct}%`;
          }
        } 
      }
    ]
  },
  {
    name: "CR",
    value: 35.2,
    itemStyle: { color: '#e31a1c' },
    label: { 
        position: 'inside', 
        fontSize: 14, 
        color: '#fff', 
        fontWeight: 'bold',
        formatter: function(params) {
            const pct = (params.value / TOTAL * 100).toFixed(1);
            return `${params.name}\n${pct}%`;
        }
    }, // Parent inside
    children: [
      { 
        name: "CR1", 
        value: 35.2*0.90, 
        itemStyle: { color: '#e31a1c' },
        label: { 
            position: 'outside', 
            fontSize: 12, 
            color: '#fff',
            formatter: function(params) {
                const pct = (params.value / TOTAL * 100).toFixed(1);
                return `${params.name}\n${pct}%`;
            }
        }
      },
      { 
        name: "CR2", 
        value: 35.2*0.08, 
        itemStyle: { color: '#b30000' },
        label: { 
            position: 'outside', 
            fontSize: 12, 
            color: '#fff',
            formatter: function(params) {
                const pct = (params.value / TOTAL * 100).toFixed(1);
                return `${params.name}\n${pct}%`;
            }
        }
      },
      { 
        name: "CR3", 
        value: 35.2*0.02, 
        itemStyle: { color: '#7f0000' },
        label: { 
          position: ['50%','100%'], // personalizzabile
          fontSize: 12, 
          color: '#fff',
          formatter: function(params) {
              const pct = (params.value / TOTAL * 100).toFixed(1);
              return `${params.name}\n${pct}%`;
          }
        } 
      }
    ]
  },
  {
    name: "NO",
    value: 2.7,
    itemStyle: { color: '#2ecc71' },
    label: { 
        position: 'inside', 
        fontSize: 14, 
        color: '#fff', 
        fontWeight: 'bold',
        formatter: function(params) {
            const pct = (params.value / TOTAL * 100).toFixed(1);
            return `${params.name}\n${pct}%`;
        }
    } // Parent inside
  }
];

const TOTAL = sunburstData.reduce((s, d) => s + d.value, 0);

chart3.setOption({
  tooltip: {
    backgroundColor: 'rgba(0,0,0,0.8)',
    borderColor: '#00ffe0',
    textStyle: { color: '#fff' },
    formatter: function (params) {
      const globalPct = (params.value / TOTAL * 100).toFixed(2);
      let localPct = '';
      if (params.treePathInfo.length > 1) {
        const parent = params.treePathInfo[1].value;
        localPct = ` (${(params.value / parent * 100).toFixed(2)}% of ${params.treePathInfo[1].name})`;
      }
      return `<b>${params.name}</b><br/>${globalPct}%${localPct}`;
    }
  },
  legend: {
    orient: 'vertical',
    right: 20,
    top: 'middle',
    textStyle: { color: '#9aa4b2' },
    formatter: function (name) {
      const item = sunburstData.find(d => d.name === name);
      if (!item) return name;
      return `${name}: ${(item.value / TOTAL * 100).toFixed(1)}%`;
    }
  },

  series: {
    type: 'sunburst',
    data: sunburstData,
    radius: ['15%', '85%'],
    label: { rotate: 0 }, // tutte le label orizzontali
    itemStyle: {
      borderColor: '#1a1a2e',
      borderWidth: 3
    },
    levels: [
      { r0: '0%', r: '15%' },   // Parent NO
      { r0: '15%', r: '50%' },  // Parent CN, CR
      { r0: '50%', r: '70%' }   // Children
    ]
  }
});

// Resize all charts on window resize
window.addEventListener('resize', () => {
  chart1.resize();
  chart2.resize();
  chart3.resize();
});

// Expandable cards for mobile
document.querySelectorAll('.expandable-card').forEach(card => {
  card.addEventListener('click', () => {
    if (window.innerWidth <= 768) {
      card.classList.toggle('expanded');
    }
  });
});

</script>

<!-- Popup HTML -->
<div id="overlay"></div>
<div id="popup">
  <h3>Critical Information</h3>
  <div id="popupContent"></div>
  <button onclick="closePopup()">Close</button>
</div>

</body>
</html>


    <!-- AG Grid JS -->
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.noStyle.js"></script>
    <script>

function formatCritical(text) {
    // Esempio input:
    // CR1: 13 | CR2: 3 | CR3: 2 (E: 1, H: 1)

    const [main, extra] = text.split("(");
    const parts = main.split("|").map(p => p.trim());

    let html = `<div class="critical-container">`;

    parts.forEach(p => {
        const [label, value] = p.split(":").map(x => x.trim());
        html += `
            <div class="critical-badge ${label.toLowerCase()}">
                <span>${label}</span>
                <strong>${value}</strong>
            </div>
        `;
    });

    if (extra) {
        html += `<div class="critical-extra">(${extra}</div>`;
    }

    html += `</div>`;
    return html;
}


// Dati
        const rowData = [
            { name: "SpaceX(52648)_vs_58200", date: "2025-02-09 15:48:06", value: 25, critical: "CR1: 13 | CR2: 3 | CR3: 2 (E: 1, H: 1)" },
            { name: "SpaceX(56905)_vs_54412", date: "2025-08-08 05:48:56", value: 24, critical: "CR1: 6 | CR2: 9 | CR3: 0 (E: 0, H: 0)" },
            { name: "SpaceX(56795)_vs_60760", date: "2025-08-07 11:45:51", value: 21, critical: "CR1: 9 | CR2: 6 | CR3: 0 (E: 0, H: 0)" },
            { name: "SpaceX(54810)_vs_60776", date: "2025-06-10 17:46:25", value: 20, critical: "CR1: 8 | CR2: 6 | CR3: 0 (E: 0, H: 0)" },
            { name: "SpaceX(56352)_vs_61163", date: "2025-06-10 05:42:44", value: 20, critical: "CR1: 4 | CR2: 8 | CR3: 0 (E: 0, H: 0)" }
        ];

        // Colonne visibili
        const columnDefs = [
            {
  headerName: "Name",
  field: "name",
  cellRenderer: params => {
    if (!params.value) return "";

    // Esempio input:
    // SpaceX(52648)_vs_58200
    const match = params.value.match(/(\w+)\((\d+)\)_vs_(\d+)/);
    if (!match) return params.value;

    const [, company, id1, id2] = match;

    return `
      <div class="name-cell">
        <div class="name-company">${company}</div>
        <div class="name-ids">${id1} <span class="vs">vs.</span> ${id2}</div>
      </div>
    `;
  }
},
            { 
                headerName: "Date", 
                field: "date", 
                valueFormatter: params => {
                    const date = new Date(params.value);
                    if (window.innerWidth <= 768) {
                        return date.toISOString().split('T')[0]; // YYYY-MM-DD
                    } else {
                        return params.value;
                    }
                }
            },
            { headerName: "Value", field: "value"},
            {
  headerName: "",
  cellRenderer: params => {
    const btn = document.createElement("button");
    btn.className = "action-btn";
    btn.innerHTML = `<span class="btn-text">View</span> <span class="btn-icon">ðŸ”</span>`;
    btn.addEventListener("click", () => showPopup(params.data.critical));
    return btn;
  }
} ];

        // Grid options
        const gridOptions = {
            columnDefs: columnDefs,
            rowData: rowData,
              autoSizeStrategy: {
    type: 'fitCellContents'
  },
            defaultColDef: {
                resizable: true,
            },
            onGridReady: params => {
                params.api.autoSizeColumns(['name', 'date', 'value']);
            }
        };

        // Inizializzazione AG Grid
        const eGridDiv = document.getElementById('myGrid');
        new agGrid.createGrid(eGridDiv, gridOptions);

        // Refresh cells on resize to update formatters
        // window.addEventListener('resize', () => {
        //     gridOptions.api.refreshCells({ force: true });
        // });

        // Funzioni popup
        const popup = document.getElementById('popup');
        const overlay = document.getElementById('overlay');
        const popupContent = document.getElementById('popupContent');

        function showPopup(data) {
            popupContent.innerText = `${data.critical}`;
            popup.classList.add('show');
            overlay.classList.add('show');
        }

function showPopup(data) {
    popupContent.innerHTML = formatCritical(data);
    popup.classList.add('show');
    overlay.classList.add('show');
}

function closePopup() {
    popup.classList.remove('show');
    overlay.classList.remove('show');
}

        // Chiudi popup cliccando sull'overlay
        overlay.addEventListener('click', closePopup);
    </script>

<script>

/* =======================
   FORMAT CRITICAL (NEW)
======================= */
function conjFormatCritical(text) {
    const [main, extra] = text.split("(");
    const parts = main.split("|").map(p => p.trim());

    let html = `<div class="critical-container">`;

    parts.forEach(p => {
        const [label, value] = p.split(":").map(x => x.trim());
        html += `
            <div class="critical-badge ${label.toLowerCase()}">
                <span>${label}</span>
                <strong>${value}</strong>
            </div>
        `;
    });

    if (extra) {
        html += `<div class="critical-extra">(${extra}</div>`;
    }

    html += `</div>`;
    return html;
}

/* =======================
   DATI (NEW)
======================= */
const conjRowData = [
    {
        conjName: "SpaceX(52648)_vs_58200",
        conjDate: "2025-02-09 15:48:06",
        conjTCA: 25,
        conjCritical: "CR1: 13 | CR2: 3 | CR3: 2 (E: 1, H: 1)",
        conjCriticalCDMs: 18
    },
    {
        conjName: "HawkEye 360(48948)_vs_61800",
        conjDate: "2025-08-06 23:26:55",
        conjTCA: 17,
        conjCritical: "CR1: 17 | CR2: 0 | CR3: 0 (E: 0, H: 0)",
        conjCriticalCDMs: 17
    },
    {
        conjName: "OneWeb(56715)_vs_54393",
        conjDate: "2025-08-13 10:59:34",
        conjTCA: 16,
        conjCritical: "CR1: 16 | CR2: 0 | CR3: 0 (E: 0, H: 0)",
        conjCriticalCDMs: 16
    },
    {
        conjName: "SpaceX(56905)_vs_54412",
        conjDate: "2025-08-08 05:48:56",
        conjTCA: 24,
        conjCritical: "CR1: 6 | CR2: 9 | CR3: 0 (E: 0, H: 0)",
        conjCriticalCDMs: 15
    },
    {
        conjName: "SpaceX(56795)_vs_60760",
        conjDate: "2025-08-07 11:45:51",
        conjTCA: 21,
        conjCritical: "CR1: 9 | CR2: 6 | CR3: 0 (E: 0, H: 0)",
        conjCriticalCDMs: 15
    }
];

/* =======================
   COLONNE (NEW)
======================= */
const conjColumnDefs = [

    {
        headerName: "Conjunction",
        field: "conjName",
        cellRenderer: params => {
            if (!params.value) return "";
            const match = params.value.match(/(.+)\((\d+)\)_vs_(\d+)/);
            if (!match) return params.value;

            const [, company, id1, id2] = match;

            return `
              <div class="name-cell">
                <div class="name-company">${company}</div>
                <div class="name-ids">${id1} <span class="vs">vs.</span> ${id2}</div>
              </div>
            `;
        }
    },
    {
        headerName: "Date",
        field: "conjDate",
        valueFormatter: params => {
            const date = new Date(params.value);
            if (window.innerWidth <= 768) {
                return date.toISOString().split('T')[0]; // YYYY-MM-DD
            } else {
                return params.value;
            }
        }
    },

    {
        headerName: "TCA",
        field: "conjTCA"
    },


    {
        headerName: "NÂ° Critical CDMs",
        field: "conjCriticalCDMs"
    },

    {
        headerName: "",
        cellRenderer: params => {
            const btn = document.createElement("button");
            btn.className = "action-btn";
            btn.innerHTML = `<span class="btn-text">View</span> <span class="btn-icon">ðŸ”</span>`;
            btn.addEventListener("click", () => showPopup(params.data.conjCritical));
            return btn;
        }
    }
];

/* =======================
   GRID OPTIONS (NEW)
======================= */
const conjGridOptions = {
    columnDefs: conjColumnDefs,
    rowData: conjRowData,
    autoSizeStrategy: {
        type: 'fitCellContents'
    },
    defaultColDef: {
        resizable: true
    }
};

/* =======================
   INIT GRID (NEW)
======================= */
const conjGridDiv = document.getElementById('myGridConjunction');
new agGrid.createGrid(conjGridDiv, conjGridOptions);

/* =======================
   POPUP (NEW)
======================= */
// const conjPopup = document.getElementById('popup');
// const conjOverlay = document.getElementById('overlay');
// const conjPopupContent = document.getElementById('popupContent');

// function conjShowPopup(data) {
//     conjPopupContent.innerHTML = conjFormatCritical(data);
//     conjPopup.classList.add('show');
//     conjOverlay.classList.add('show');
// }

// function conjClosePopup() {
//     conjPopup.classList.remove('show');
//     conjOverlay.classList.remove('show');
// }

// conjOverlay.addEventListener('click', conjClosePopup);

</script>


<script>

/* =======================
   FORMAT CRITICAL (EVENTS)
======================= */
function evtFormatCritical(text) {
    if (!text) return "";
    const [main, extra] = text.split("(");
    const parts = main.split("|").map(p => p.trim()).filter(Boolean);

    let html = `<div class="critical-container">`;

    parts.forEach(p => {
        const [label, value] = p.split(":").map(x => x.trim());
        if (!label || !value) return;

        html += `
            <div class="critical-badge ${label.toLowerCase()}">
                <span>${label}</span>
                <strong>${value}</strong>
            </div>
        `;
    });

    if (extra) {
        html += `<div class="critical-extra">(${extra}</div>`;
    }

    html += `</div>`;
    return html;
}

/* =======================
   DATI (EVENTS)
======================= */
const evtRowData = [
    {
        evtName: "SpaceX(44933)_vs_55224",
        evtEvents: 67,
        evtCDMs: 157,
        evtCriticalScore: "CR1: 41 | CR2: 0 | CR3: 0",
        evtCriticalCount: 41,
        evtFirstTCA: "2025-08-08 19:16:44",
        evtLastTCA: "2025-08-11 18:52:10",
        evtAvgDelta: 65
    },
    {
        evtName: "SpaceX(58524)_vs_54887",
        evtEvents: 65,
        evtCDMs: 475,
        evtCriticalScore: "CR1: 154 | CR2: 0 | CR3: 0",
        evtCriticalCount: 154,
        evtFirstTCA: "2025-08-08 23:42:34",
        evtLastTCA: "2025-08-11 17:58:52",
        evtAvgDelta: 62
    },
    {
        evtName: "SpaceX(53536)_vs_54934",
        evtEvents: 64,
        evtCDMs: 352,
        evtCriticalScore: "CR1: 174 | CR2: 0 | CR3: 0",
        evtCriticalCount: 174,
        evtFirstTCA: "2025-02-07 13:32:41",
        evtLastTCA: "2025-02-09 21:13:23",
        evtAvgDelta: 53
    },
    {
        evtName: "SpaceX(53172)_vs_55549",
        evtEvents: 63,
        evtCDMs: 278,
        evtCriticalScore: "CR1: 146 | CR2: 3 | CR3: 0",
        evtCriticalCount: 152,
        evtFirstTCA: "2025-06-05 03:32:20",
        evtLastTCA: "2025-06-11 05:53:16",
        evtAvgDelta: 142
    },
    {
        evtName: "SpaceX(53009)_vs_54934",
        evtEvents: 63,
        evtCDMs: 328,
        evtCriticalScore: "CR1: 85 | CR2: 0 | CR3: 0",
        evtCriticalCount: 85,
        evtFirstTCA: "2025-02-07 18:18:34",
        evtLastTCA: "2025-02-10 23:27:38",
        evtAvgDelta: 75
    }
];

/* =======================
   COLONNE (EVENTS)
======================= */
const evtColumnDefs = [

    {
        headerName: "Conjunction",
        field: "evtName",
        cellRenderer: params => {
            if (!params.value) return "";
            const match = params.value.match(/(.+)\((\d+)\)_vs_(\d+)/);
            if (!match) return params.value;

            const [, company, id1, id2] = match;

            return `
              <div class="name-cell">
                <div class="name-company">${company}</div>
                <div class="name-ids">${id1} <span class="vs">vs.</span> ${id2}</div>
              </div>
            `;
        }
    },

    { headerName: "NÂ° Events", field: "evtEvents" },

    { headerName: "NÂ° CDMs", field: "evtCDMs" },


    { headerName: "Critical Count", field: "evtCriticalCount" },

    { headerName: "First TCA", field: "evtFirstTCA" },

    { headerName: "Last TCA", field: "evtLastTCA" },

    { headerName: "Avg Delta [mins]", field: "evtAvgDelta" },

    {
        headerName: "",
        cellRenderer: params => {
            const btn = document.createElement("button");
            btn.className = "action-btn";
            btn.innerHTML = `<span class="btn-text">View</span> <span class="btn-icon">ðŸ”</span>`;
            btn.addEventListener("click", () => showPopup(params.data.evtCriticalScore));
            return btn;
        }
    }
];

/* =======================
   GRID OPTIONS (EVENTS)
======================= */
const evtGridOptions = {
    columnDefs: evtColumnDefs,
    rowData: evtRowData,
    autoSizeStrategy: {
        type: 'fitCellContents'
    },
    defaultColDef: {
        resizable: true
    }
};

/* =======================
   INIT GRID (EVENTS)
======================= */
const evtGridDiv = document.getElementById('myGridEvents');
new agGrid.createGrid(evtGridDiv, evtGridOptions);

</script>


<script>

/* =======================
   FORMAT CRITICAL (EVENTS 2)
======================= */
function evt2FormatCritical(text) {
    if (!text) return "";
    const [main, extra] = text.split("(");
    const parts = main.split("|").map(p => p.trim()).filter(Boolean);

    let html = `<div class="critical-container">`;

    parts.forEach(p => {
        const [label, value] = p.split(":").map(x => x.trim());
        if (!label || !value) return;

        html += `
            <div class="critical-badge ${label.toLowerCase()}">
                <span>${label}</span>
                <strong>${value}</strong>
            </div>
        `;
    });

    if (extra) {
        html += `<div class="critical-extra">(${extra}</div>`;
    }

    html += `</div>`;
    return html;
}

/* =======================
   DATI (EVENTS 2)
======================= */
const evt2RowData = [
    {
        evt2Name: "OneWeb (61604)_vs_61454",
        evt2Events: 16,
        evt2CDMs: 490,
        evt2CriticalScore: "CR1: 89 | CR2: 0 | CR3: 0",
        evt2CriticalCount: 89,
        evt2FirstTCA: "2025-02-09 18:46:47",
        evt2LastTCA: "2025-02-12 01:29:54",
        evt2AvgDelta: 219
    },
    {
        evt2Name: "SpaceX(54763)_vs_52152",
        evt2Events: 51,
        evt2CDMs: 485,
        evt2CriticalScore: "CR1: 205 | CR2: 0 | CR3: 0",
        evt2CriticalCount: 205,
        evt2FirstTCA: "2025-06-08 09:27:21",
        evt2LastTCA: "2025-08-08 05:31:50",
        evt2AvgDelta: 1752
    },
    {
        evt2Name: "SpaceX(58524)_vs_54887",
        evt2Events: 65,
        evt2CDMs: 475,
        evt2CriticalScore: "CR1: 154 | CR2: 0 | CR3: 0",
        evt2CriticalCount: 154,
        evt2FirstTCA: "2025-08-08 23:42:34",
        evt2LastTCA: "2025-08-11 17:58:52",
        evt2AvgDelta: 62
    },
    {
        evt2Name: "SpaceX(56914)_vs_61397",
        evt2Events: 55,
        evt2CDMs: 388,
        evt2CriticalScore: "CR1: 173 | CR2: 2 | CR3: 0",
        evt2CriticalCount: 177,
        evt2FirstTCA: "2025-06-05 12:49:54",
        evt2LastTCA: "2025-06-09 03:05:35",
        evt2AvgDelta: 96
    },
    {
        evt2Name: "SpaceX(53078)_vs_60213",
        evt2Events: 60,
        evt2CDMs: 375,
        evt2CriticalScore: "CR1: 188 | CR2: 0 | CR3: 0",
        evt2CriticalCount: 188,
        evt2FirstTCA: "2025-08-05 07:13:52",
        evt2LastTCA: "2025-08-09 05:37:12",
        evt2AvgDelta: 96
    }
];

/* =======================
   COLONNE (EVENTS 2)
======================= */
const evt2ColumnDefs = [

    {
        headerName: "Conjunction",
        field: "evt2Name",
        cellRenderer: params => {
            if (!params.value) return "";
            const match = params.value.match(/(.+?)\s*\((\d+)\)_vs_(\d+)/);
            if (!match) return params.value;

            const [, company, id1, id2] = match;

            return `
              <div class="name-cell">
                <div class="name-company">${company}</div>
                <div class="name-ids">${id1} <span class="vs">vs.</span> ${id2}</div>
              </div>
            `;
        }
    },

    { headerName: "NÂ° Events", field: "evt2Events" },

    { headerName: "NÂ° CDMs", field: "evt2CDMs" },


    { headerName: "Critical Count", field: "evt2CriticalCount" },

    { headerName: "First TCA", field: "evt2FirstTCA" },

    { headerName: "Last TCA", field: "evt2LastTCA" },

    { headerName: "Avg Delta [mins]", field: "evt2AvgDelta" },
            {
  headerName: "",
  cellRenderer: params => {
    const btn = document.createElement("button");
    btn.className = "action-btn";
    btn.innerHTML = `<span class="btn-text">View</span> <span class="btn-icon">ðŸ”</span>`;
    btn.addEventListener("click", () => showPopup(params.data.evt2CriticalScore));
    return btn;
  }
}
];

/* =======================
   GRID OPTIONS (EVENTS 2)
======================= */
const evt2GridOptions = {
    columnDefs: evt2ColumnDefs,
    rowData: evt2RowData,
    autoSizeStrategy: {
        type: 'fitCellContents'
    },
    defaultColDef: {
        resizable: true
    }
};

/* =======================
   INIT GRID (EVENTS 2)
======================= */
const evt2GridDiv = document.getElementById('myGridEvents2');
new agGrid.createGrid(evt2GridDiv, evt2GridOptions);

</script>












<!-- script test per espandere in basso -->

<script>
// ======================= UTILITY - Parse Critical Score =======================

function parseCriticalScore(text) {
  const match = text.match(/CR1:\s*(\d+)\s*\|\s*CR2:\s*(\d+)\s*\|\s*CR3:\s*(\d+)/);
  if (!match) return { cr1: 0, cr2: 0, cr3: 0 };

  return {
    cr1: parseInt(match[1]),
    cr2: parseInt(match[2]),
    cr3: parseInt(match[3])
  };
}

// ======================= DATI BASE (senza dettagli) =======================

const baseRowData = [
  {
    id: 1,
    evt3Name: "SpaceX(54763)_vs_52152",
    evt3Events: 51,
    evt3CDMs: 485,
    evt3CriticalScore: "CR1: 205 | CR2: 0 | CR3: 0",
    evt3CriticalCount: 205,
    evt3FirstTCA: "2025-06-08 09:27:21",
    evt3LastTCA: "2025-08-08 05:31:50",
    evt3AvgDelta: 1752,
    expanded: false
  },
  {
    id: 2,
    evt3Name: "SpaceX(53078)_vs_60213",
    evt3Events: 60,
    evt3CDMs: 375,
    evt3CriticalScore: "CR1: 188 | CR2: 0 | CR3: 0",
    evt3CriticalCount: 188,
    evt3FirstTCA: "2025-08-05 07:13:52",
    evt3LastTCA: "2025-08-09 05:37:12",
    evt3AvgDelta: 96,
    expanded: false
  },
  {
    id: 3,
    evt3Name: "SpaceX(56914)_vs_61397",
    evt3Events: 55,
    evt3CDMs: 388,
    evt3CriticalScore: "CR1: 173 | CR2: 2 | CR3: 0",
    evt3CriticalCount: 177,
    evt3FirstTCA: "2025-06-05 12:49:54",
    evt3LastTCA: "2025-06-09 03:05:35",
    evt3AvgDelta: 96,
    expanded: false
  },
  {
    id: 4,
    evt3Name: "SpaceX(53536)_vs_54934",
    evt3Events: 64,
    evt3CDMs: 352,
    evt3CriticalScore: "CR1: 174 | CR2: 0 | CR3: 0",
    evt3CriticalCount: 174,
    evt3FirstTCA: "2025-02-07 13:32:41",
    evt3LastTCA: "2025-02-09 21:13:23",
    evt3AvgDelta: 53,
    expanded: false
  },
  {
    id: 5,
    evt3Name: "SpaceX(54080)_vs_52152",
    evt3Events: 42,
    evt3CDMs: 328,
    evt3CriticalScore: "CR1: 159 | CR2: 3 | CR3: 0",
    evt3CriticalCount: 165,
    evt3FirstTCA: "2025-08-06 03:49:46",
    evt3LastTCA: "2025-08-08 21:07:20",
    evt3AvgDelta: 96,
    expanded: false
  }
];

// API globale restituita da createGrid
let gridApi4;

// ======================= FULL WIDTH ROW per dettagli =======================

function isFullWidthRow(params) {
  return params.rowNode.data && params.rowNode.data.isDetail;
}

function fullWidthCellRenderer(params) {
  const parentData = params.node.data.parentData;

  // ATTENZIONE: qui nel tuo snippet originale c'era evt4CriticalScore.
  // Se il campo corretto Ã¨ evt3CriticalScore, usa quello:
  const scores = parseCriticalScore(parentData.evt3CriticalScore);

  const total = scores.cr1 + scores.cr2 + scores.cr3;

  const container = document.createElement('div');

  container.innerHTML = `
    <div class="detail-container" style="position: relative;">
    

      <div class="detail-label">Critical Level 1</div>
      <div class="detail-value">${scores.cr1}</div>

      <div class="detail-label">Critical Level 2</div>
      <div class="detail-value">${scores.cr2}</div>

      <div class="detail-label">Critical Level 3</div>
      <div class="detail-value">${scores.cr3}</div>

      <div class="detail-label">Total Critical</div>
      <div class="detail-value">${total}</div>
    </div>
  `;

  // const closeBtn = container.querySelector('.close-detail');
  // closeBtn.addEventListener('click', () => {
  //   toggleExpand(parentData.id);
  // });

  return container;
}

// ======================= TOGGLE EXPAND =======================

function toggleExpand(rowId) {
  if (!gridApi4) return;

  const newData = [];

  baseRowData.forEach(row => {
    if (row.id === rowId) {
      row.expanded = !row.expanded;
    }

    newData.push(row);

    if (row.expanded && row.id === rowId) {
      newData.push({
        id: `detail-${row.id}`,
        isDetail: true,
        parentData: row
      });
    }
  });

  // AG Grid v31+: usare setGridOption per aggiornare rowData
  gridApi4.setGridOption('rowData', newData);
}

// ======================= COLONNE =======================

const evt4ColumnDefs = [
  {
    headerName: "",
    field: "expand",
    width: 45,
    cellRenderer: params => {
      if (params.data.isDetail) return '';
      const expandedClass = params.data.expanded ? 'expanded' : '';
      return `<span class="expand-icon ${expandedClass}">â–¶</span>`;
    },
    cellStyle: { cursor: 'pointer', textAlign: 'center' }
  },
      {
        headerName: "Conjunction",
        field: "evt3Name",
        width: 150,
        cellRenderer: params => {
            if (!params.value) return "";
            const match = params.value.match(/(.+)\((\d+)\)_vs_(\d+)/);
            if (!match) return params.value;

            const [, company, id1, id2] = match;

            return `
              <div class="name-cell">
                <div class="name-company">${company}</div>
                <div class="name-ids">${id1} <span class="vs">vs.</span> ${id2}</div>
              </div>
            `;
        }
    },
  { headerName: "NÂ° Events", field: "evt3Events", width: 100, fontSize: 13 },
  { headerName: "NÂ° CDMs", field: "evt3CDMs", width: 120 },
  { headerName: "First TCA", field: "evt3FirstTCA", width: 180 },
  { headerName: "Last TCA", field: "evt3LastTCA", width: 180 },
  { headerName: "Avg Î” [min]", field: "evt3AvgDelta", width: 120 }
];

// ======================= GRID OPTIONS =======================

const evt4GridOptions = {
  columnDefs: evt4ColumnDefs,
  rowData: baseRowData,
  defaultColDef: {
    resizable: true,
    // sortable: true
  },
  getRowId: params => params.data.id,
  isFullWidthRow: isFullWidthRow,
  fullWidthCellRenderer: fullWidthCellRenderer,
  getRowHeight: params => {
    return params.data.isDetail ? 200 : 50;
  },
  onCellClicked: params => {
    if (params.data.isDetail) return;

    if (
      params.column.colId === 'expand' ||
      params.column.colId === 'evt3CriticalScore'
    ) {
      toggleExpand(params.data.id);
    }
  },
  onGridReady: params => {
    console.log('Grid ready');
    // Volendo, puoi anche usare params.api se ti serve,
    // ma con createGrid usiamo l'API ritornata (gridApi4)
  }
};

// ======================= INIT GRID =======================

const evt4GridDiv = document.getElementById('myGridEvents4');
gridApi4 = agGrid.createGrid(evt4GridDiv, evt4GridOptions);
</script>




